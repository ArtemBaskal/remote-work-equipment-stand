(this["webpackJsonpremote-work-equipment-stand"]=this["webpackJsonpremote-work-equipment-stand"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n.n(c),i=n(15),l=n(28),u=n(16),s=n(40),d=n(45),m=Object(u.c)({auth:s.b,led:d.a});var f=Object(l.a)({reducer:m});n(94);!function(){var e=n(99).default;o.a.render(r.a.createElement(i.a,{store:f},r.a.createElement(e,null)),document.getElementById("root"))}()},40:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return l}));var a=n(28),r={},c=Object(a.b)({name:"auth",initialState:r,reducers:{getProfile:function(e,t){return t.payload},clearProfile:function(){return r}}}),o=c.actions,i=o.getProfile,l=o.clearProfile;t.b=c.reducer},45:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var a=n(28),r=Object(a.b)({name:"led",initialState:{pin1:!1,pin2:!1,pin3:!1},reducers:{setLed:function(e,t){return t.payload}}}),c=r.actions.setLed;t.a=r.reducer},56:function(e){e.exports=JSON.parse('{"GOOGLE_AUTH":"930914015370-b31p63biqg1j0pbfr96qei9ujp1ttded.apps.googleusercontent.com"}')},84:function(e,t,n){e.exports=n(100)},94:function(e,t,n){},96:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(55),o=n(40),i=n(15),l=n(128),u=n(130),s=n(131),d=n(132),m=n(145),f=n(133),v=n(134),b=n(56),p=n(126),g=Object(p.a)((function(){return{root:{flexGrow:1}}})),E=function(){var e=Object(i.c)(),t=Object(i.d)((function(e){return e.auth}),i.b),n=t.imageUrl,a=t.email,p=t.name,E=g(),O=!!p;return r.a.createElement(l.a,null,r.a.createElement("div",{className:E.root},r.a.createElement(u.a,null,r.a.createElement(s.a,null,p&&r.a.createElement(d.a,null,r.a.createElement(m.a,null,r.a.createElement(m.a,{alt:p,src:n}))),r.a.createElement(f.a,{primary:p,secondary:a}),r.a.createElement(v.a,null,O?r.a.createElement(c.GoogleLogout,{clientId:b.GOOGLE_AUTH,buttonText:"\u0412\u044b\u0439\u0442\u0438",onLogoutSuccess:function(){e(Object(o.a)())}}):r.a.createElement(c.GoogleLogin,{clientId:b.GOOGLE_AUTH,buttonText:"\u0412\u043e\u0439\u0442\u0438",onSuccess:function(t){e(Object(o.c)(t.profileObj))},onFailure:function(e){console.error(e)},cookiePolicy:"single_host_origin",isSignedIn:!0}))))))},O=n(44),h=n.n(O),j=n(57),y=n(17),S=n(70),L=n(71),k=function(){function e(t){Object(S.a)(this,e),this.signaling=t}return Object(L.a)(e,[{key:"send",value:function(e){this.signaling.send(JSON.stringify({data:e}))}},{key:"unsubscribe",value:function(){console.error("Method unsubscribe is not implemented")}},{key:"onmessage",set:function(e){var t=this,n=function(t){var n=t.data;e(JSON.parse(n))};this.signaling.addEventListener("message",n),this.unsubscribe=function(){console.log("unsubscribe from message"),t.signaling.removeEventListener("message",n)}}}]),e}(),w=n(72),x=n(141),P=n(135),C=n(51),N=function(e){var t=e.value;return r.a.createElement(x.a,{display:"flex",alignItems:"center"},r.a.createElement(x.a,{width:"100%",mr:1},r.a.createElement(P.a,Object.assign({variant:"determinate"},e))),r.a.createElement(x.a,{minWidth:35},r.a.createElement(C.a,{variant:"body2",color:"textSecondary"},"".concat(Math.round(t),"%"))))},F=(n(96),n(136)),I=n(146),_=n(140),D=n(138),W=n(139),G=n(144),R=n(73),q=n.n(R),T=n(74),A=n.n(T),J=n(142),U={iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"9u7prU:2}R{Sut~.)d[bP7,;Pgc'Pa",username:"fkrveacbukypqsqyaq@miucce.com"}]},z=Object(p.a)((function(e){return{root:{flexGrow:1,maxWidth:"20rem","& > *":{margin:e.spacing(1)}},progress:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120}}})),B=function(){var e=z(),t=Object(a.useRef)(null),n=Object(a.useRef)(null),c=Object(a.useState)(0),o=Object(y.a)(c,2),i=o[0],l=o[1],b=Object(a.useState)(0),p=Object(y.a)(b,2),g=p[0],E=p[1],O=Object(a.useState)(null),S=Object(y.a)(O,2),L=S[0],x=S[1],P=Object(a.useState)(!1),R=Object(y.a)(P,2),T=R[0],B=R[1],H=Object(a.useState)(""),M=Object(y.a)(H,2),K=M[0],Q=M[1],V=function(){return x(null)},X=function(){return B(!1)};Object(a.useEffect)((function(){if(""!==K){var e,a,r,c=(e="room",a=K,new URLSearchParams(Object(w.a)({},e,a)).toString()),o=new WebSocket("wss://wss-signaling.herokuapp.com/".concat(c&&"?".concat(c))),i=function(e){console.log("OPEN WS",e),r=new k(o);var a=new RTCPeerConnection(U);n.current=a,a.ontrack=function(e){var n=e.track,a=Object(y.a)(e.streams,1)[0];n.onunmute=function(){t.current.srcObject||(t.current.srcObject=a)}};var c=!1,i=!1,l=!1;a.onicecandidate=function(e){var t=e.candidate;r.send({candidate:t})},a.onnegotiationneeded=Object(j.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=!0,e.next=4,a.setLocalDescription();case 4:r.send({description:a.localDescription}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:return e.prev=10,c=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])}))),a.oniceconnectionstatechange=function(){"failed"===a.iceConnectionState&&a.restartIce()},r.onmessage=function(){var e=Object(j.a)(h.a.mark((function e(t){var n,o,u,s,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,o=t.data,u=o.description,s=o.candidate,console.log(n),e.prev=2,!u){e.next=19;break}if(d=!c&&("stable"===a.signalingState||l),"offer"===u.type&&!d,!(i=!1)){e.next=9;break}return e.abrupt("return");case 9:return l="answer"===u.type,e.next=12,a.setRemoteDescription(u);case 12:if(l=!1,"offer"!==u.type){e.next=17;break}return e.next=16,a.setLocalDescription();case 16:r.send({description:a.localDescription});case 17:e.next=29;break;case 19:if(!s){e.next=29;break}return e.prev=20,e.next=23,a.addIceCandidate(s);case 23:e.next=29;break;case 25:if(e.prev=25,e.t0=e.catch(20),i){e.next=29;break}throw e.t0;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(2),console.error(e.t1);case 34:case"end":return e.stop()}}),e,null,[[2,31],[20,25]])})));return function(t){return e.apply(this,arguments)}}();var u=function(e){var t=e.target.readyState;console.log("Send channel state is: %s",t)};a.addEventListener("datachannel",(function(e){var t=e.channel;t.addEventListener("message",(function(e){console.log("Received Message: %s",e.data)})),t.addEventListener("open",u),t.addEventListener("close",u)}))};return o.addEventListener("open",i),o.addEventListener("close",(function(e){console.log("CLOSE WS",e)})),function(){o.close(1e3,"change room"),o.removeEventListener("open",i),r&&r.unsubscribe(),t.current.srcObject=null}}}),[K]),Object(a.useEffect)((function(){var e=window;function t(e){e.stopPropagation(),e.preventDefault()}function n(e){e.stopPropagation(),e.preventDefault()}function a(e){e.stopPropagation(),e.preventDefault();var t=Object(y.a)(e.dataTransfer.files,1)[0];x(t)}return e.addEventListener("dragenter",t,!1),e.addEventListener("dragover",n,!1),e.addEventListener("drop",a,!1),function(){e.removeEventListener("dragenter",t,!1),e.removeEventListener("dragover",n,!1),e.removeEventListener("drop",a,!1)}}),[]),Object(a.useEffect)((function(){var e=function(){"visible"===document.visibilityState&&document.pictureInPictureElement&&document.exitPictureInPicture()};return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}}),[]);var Y,Z;return r.a.createElement("div",{className:e.root},r.a.createElement(F.a,{variant:"filled",className:e.formControl},r.a.createElement(I.a,{htmlFor:"outlined-room-native-simple"},"\u0421\u0442\u0435\u043d\u0434"),r.a.createElement(_.a,{native:!0,value:K,onChange:function(e){Q(e.target.value)},label:"\u0421\u0442\u0435\u043d\u0434\u0430",inputProps:{name:"\u0421\u0442\u0435\u043d\u0434",id:"outlined-room-native-simple"}},Array.from({length:4},(function(e,t){return t})).map((function(e){var t=0===e,n=t?"":e.toString();return r.a.createElement("option",{key:n,value:n,disabled:t,"aria-label":t?"None":n},n)})))),r.a.createElement("section",null,r.a.createElement(C.a,{variant:"h5",gutterBottom:!0},"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u0430 \u043f\u0440\u043e\u0448\u0438\u0432\u043a\u0438"),r.a.createElement("input",{type:"file",id:"files",style:{display:"none"},onChange:function(e){var t=Object(y.a)(e.target.files,1)[0];x(t)}}),L&&r.a.createElement(u.a,null,r.a.createElement(s.a,null,r.a.createElement(d.a,null,r.a.createElement(m.a,null,r.a.createElement(q.a,null))),r.a.createElement(f.a,{primary:L.name,secondary:L.lastModifiedDate.toLocaleString(),title:"".concat(L.size," \u0431\u0430\u0439\u0442")}),r.a.createElement(v.a,null,r.a.createElement(D.a,{edge:"end","aria-label":"delete",onClick:V},r.a.createElement(A.a,null))))),g>0&&L?r.a.createElement("div",{className:e.progress},r.a.createElement(N,{value:(Y=g,Z=i,100*(Y-0)/(Z-0))})):r.a.createElement("br",null),r.a.createElement(W.a,{component:"label",htmlFor:"files",variant:"contained",size:"small",id:"files"},"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"),L&&r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{component:"button",color:"primary",onClick:function(){var e=n.current.createDataChannel(L.name,null);e.binaryType="arraybuffer",l(L.size);var t=new FileReader,a=0;t.addEventListener("error",(function(e){console.error("Error reading selectedFile: ",e)})),t.addEventListener("abort",(function(e){console.log("File reading aborted: ",e)}));var r=function(e){console.log("readSlice",e);var n=L.slice(a,e+16384);t.readAsArrayBuffer(n)};t.addEventListener("load",(function(t){if(console.log("FileReader.onload",t),"open"===e.readyState){var n=t.target.result;e.send(n),a+=n.byteLength,E(a),a>=L.size?(e.send("EOF"),e.close(),x(null),l(0),E(0),V(),B(!0)):e.bufferedAmount<8192&&r(a)}else console.warn("sendFileChannel.readyState is not open:",e.readyState)})),e.bufferedAmountLowThreshold=8192,e.addEventListener("bufferedamountlow",(function(){r(a)})),e.onopen=function(){r(0)}},variant:"contained",type:"submit",size:"small"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")),r.a.createElement(G.a,{open:T,autoHideDuration:6e3,onClose:X,onClick:X},r.a.createElement(J.a,{severity:"success"},"\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"))),r.a.createElement(C.a,{variant:"h5",gutterBottom:!0},"\u0412\u0438\u0434\u0435\u043e \u0441\u0442\u0435\u043d\u0434\u0430"),r.a.createElement("video",{ref:t,autoPlay:!0,playsInline:!0,onClick:function(e){var n;(null===(n=t.current)||void 0===n?void 0:n.srcObject)&&(document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&e.target.requestPictureInPicture())},poster:"".concat("/remote-work-equipment-stand","/chip.png")}))},H=n(75),M=n.n(H),K=(n(98),n(45)),Q=function(){var e=Object(i.d)((function(e){return e.led}),i.b),t=Object(i.c)(),n=Object(a.useRef)(null);Object(a.useEffect)((function(){return n.current=new WebSocket("ws://localhost:8080/ws"),n.current.onopen=function(){console.log("WS connected"),n.current.send("Ping from client")},n.current.onclose=function(e){console.log("WS closed connection",e)},n.current.onerror=function(e){console.log("WS error",e)},n.current.onmessage=function(e){console.log("WS message",e.data),t(Object(K.b)(JSON.parse(e.data)))},function(){n.current.close()}}),[]);var c=function(){n.current.send("ON")},o=function(){n.current.send("OFF")};return r.a.createElement("div",{className:"board"},r.a.createElement("div",{className:"led__container"},Object.entries(e).map((function(e,t){var n=Object(y.a)(e,2),a=n[0],c=n[1];return r.a.createElement("div",{key:a,className:"led__item"},r.a.createElement("span",null,t+1),r.a.createElement("span",{className:M()("led",{led__off:!c,led__on:c})}))}))),r.a.createElement(W.a,{variant:"contained",onClick:c,color:"primary"},"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c"),r.a.createElement(W.a,{variant:"contained",onClick:o,color:"secondary"},"\u0412\u044b\u043a\u043b\u044e\u0447\u0438\u0442\u044c"))};t.default=function(){var e=!!Object(i.d)((function(e){return e.auth.name}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(E,null),e&&r.a.createElement(r.a.Fragment,null,r.a.createElement(B,null),r.a.createElement(Q,null)))}}},[[84,1,2]]]);
//# sourceMappingURL=main.29f16c62.chunk.js.map