(this["webpackJsonpremote-work-equipment-stand"]=this["webpackJsonpremote-work-equipment-stand"]||[]).push([[0],{101:function(e,n,t){},103:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(46),o=t.n(c),i=t(60),s=t(28),u=t(71),l=t(72),d=function(){function e(n){Object(u.a)(this,e),this.signaling=n}return Object(l.a)(e,[{key:"send",value:function(e){this.signaling.send(JSON.stringify({data:e}))}},{key:"unsubscribe",value:function(){console.error("Method unsubscribe is not implemented")}},{key:"onmessage",set:function(e){var n=this,t=function(n){var t=n.data;e(JSON.parse(t))};this.signaling.addEventListener("message",t),this.unsubscribe=function(){console.log("unsubscribe from message"),n.signaling.removeEventListener("message",t)}}}]),e}(),m=t(31),f=(t(101),t(144)),b=t(155),p=t(149),g=t(157),v=t(142),E=t(135),O=t(15),h=t(17),j=t(136),k=t(137),y=t(138),S=t(154),L=t(139),w=t(140),x=t(141),P=t(153),C=t(76),R=t.n(C),D=t(77),I=t.n(D),N=t(151),T=t(150),q=t(133),F=t(56),A=function(e){var n=e.value;return r.a.createElement(T.a,{display:"flex",alignItems:"center"},r.a.createElement(T.a,{width:"100%",mr:1},r.a.createElement(q.a,Object.assign({variant:"determinate"},e))),r.a.createElement(T.a,{minWidth:35},r.a.createElement(F.a,{variant:"body2",color:"textSecondary"},"".concat(Math.round(n),"%"))))},G=Object(E.a)((function(){return{progress:{width:"100%"},file:{display:"flex"}}})),_=function(e){var n=e.pcRef,t=Object(O.c)(),c=G(),o=Object(O.d)((function(e){return e.fileLoader}),O.b),i=o.maxProgress,u=o.progressValue,l=o.snackbarSuccess,d=o.snackbarError,m=Object(a.useState)(null),f=Object(s.a)(m,2),b=f[0],p=f[1];Object(a.useEffect)((function(){var e=window;function n(e){e.stopPropagation(),e.preventDefault()}function t(e){e.stopPropagation(),e.preventDefault()}function a(e){e.stopPropagation(),e.preventDefault();var n=Object(s.a)(e.dataTransfer.files,1)[0];p(n)}return e.addEventListener("dragenter",n,!1),e.addEventListener("dragover",t,!1),e.addEventListener("drop",a,!1),function(){e.removeEventListener("dragenter",n,!1),e.removeEventListener("dragover",t,!1),e.removeEventListener("drop",a,!1)}}),[]);var g,E,C=function(){p(null)},D=function(){return t(Object(h.b)())},T=function(){return t(Object(h.a)())};return r.a.createElement("section",null,r.a.createElement("input",{type:"file",id:"files",style:{display:"none"},onChange:function(e){var n=e.target.files;p(n[0])}}),b&&r.a.createElement(j.a,{className:c.file},r.a.createElement(k.a,null,r.a.createElement(y.a,null,r.a.createElement(S.a,null,r.a.createElement(R.a,null))),r.a.createElement(L.a,{primary:b.name,secondary:new Date(b.lastModified).toLocaleString(),title:"".concat(b.size," \u0431\u0430\u0439\u0442")}),r.a.createElement(w.a,null,r.a.createElement(x.a,{edge:"end","aria-label":"delete",onClick:C},r.a.createElement(I.a,null))))),u>0&&b?r.a.createElement("div",{className:c.progress},r.a.createElement(A,{value:(g=u,E=i,100*(g-0)/(E-0))})):r.a.createElement("br",null),b&&r.a.createElement(v.a,{component:"button",color:"primary",onClick:function(){if(b&&n.current){var e=n.current.createDataChannel(b.name);e.binaryType="arraybuffer",t(Object(h.d)(b.size));var a=new FileReader,r=0;a.addEventListener("error",(function(e){console.error("Error reading selectedFile: ",e)})),a.addEventListener("abort",(function(e){console.log("File reading aborted: ",e)}));var c=!1,o=function(e){console.log("readSlice",e);var n=b.slice(r,e+262144);a.readAsArrayBuffer(n)};a.addEventListener("load",(function(n){var a;if(console.log("FileReader.onload",n),(null===(a=n.target)||void 0===a?void 0:a.result)&&"open"===e.readyState)if(c)console.warn("Unable to write, data channel is paused!");else{var i=n.target.result;if(e.send(i),r+=i.byteLength,t(Object(h.e)(r)),r>=b.size)return e.send("EOF"),e.close(),p(null),t(Object(h.d)(0)),t(Object(h.e)(0)),C(),void t(Object(h.g)("\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"));c||e.bufferedAmount<1048576?o(r):(console.log("Data channel ".concat(e.label," paused @ ").concat(e.bufferedAmount)),c=!0)}else console.warn("sendFileChannel.readyState is not open:",e.readyState)})),e.bufferedAmountLowThreshold=262144,e.addEventListener("bufferedamountlow",(function(){c&&(console.debug("Data channel ".concat(e.label," resumed @ ").concat(e.bufferedAmount)),c=!1,o(r))})),e.onopen=function(){o(0)}}},variant:"contained",type:"submit",size:"small"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),r.a.createElement(v.a,{component:"label",htmlFor:"files",variant:"contained",size:"small",id:"files"},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0448\u0438\u0432\u043a\u0443"),r.a.createElement(P.a,{open:!!l,autoHideDuration:6e3,onClose:D,onClick:D},r.a.createElement(N.a,{severity:"success"},l)),r.a.createElement(P.a,{open:!!d,onClose:T,onClick:T},r.a.createElement(N.a,{severity:"error"},d)))},U={iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"9u7prU:2}R{Sut~.)d[bP7,;Pgc'Pa",username:"fkrveacbukypqsqyaq@miucce.com"}]},z=Object(E.a)((function(e){return{root:{flexGrow:1,"& > *":{margin:e.spacing(1)},padding:"2rem"},formControl:{margin:e.spacing(1),minWidth:"10rem"},video:{display:"flex",justifyContent:"center",flexDirection:"column",backgroundImage:"url(".concat("/remote-work-equipment-stand","/chip.png)"),backgroundSize:"5.5rem",backgroundRepeat:"space",width:"100%",minHeight:"30rem"}}})),M=function(){var e=z(),n=Object(O.d)((function(e){return e.auth.id_token})),t=Object(O.c)(),c=Object(a.useRef)(null),u=Object(a.useRef)(null),l=Object(a.useRef)(null),E=Object(a.useState)(""),j=Object(s.a)(E,2),k=j[0],y=j[1],S=Object(a.useState)(!1),L=Object(s.a)(S,2),w=L[0],x=L[1],P=Object(a.useState)(""),C=Object(s.a)(P,2),R=C[0],D=C[1];Object(a.useEffect)((function(){if(""!==R){var e,a,r,l=(e="room",a=R,new URLSearchParams(Object(m.a)({},e,a)).toString()),f=new URL("".concat(l&&"?".concat(l)),"wss://wss-signaling.herokuapp.com").toString(),b=new WebSocket(f,["id_token",n]),p=function(e){console.log("OPEN WS",e),(r=new d(b)).send({getRemoteMedia:!0});var n=new RTCPeerConnection(U);u.current=n,n.ontrack=function(e){var n=e.track,t=Object(s.a)(e.streams,1)[0];n.onunmute=function(){c.current.srcObject||(c.current.srcObject=t)}};var t=!1,a=!1,l=!1;n.onicecandidate=function(e){var n=e.candidate;r.send({candidate:n})},n.onnegotiationneeded=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=!0,e.next=4,n.setLocalDescription();case 4:r.send({description:n.localDescription}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:return e.prev=10,t=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])}))),n.oniceconnectionstatechange=function(){"failed"===n.iceConnectionState&&n.restartIce()},r.onmessage=function(){var e=Object(i.a)(o.a.mark((function e(c){var i,s,u,d,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.data,s=c.data,u=s.description,d=s.candidate,console.log(i),e.prev=2,!u){e.next=19;break}if(m=!t&&("stable"===n.signalingState||l),"offer"===u.type&&!m,!(a=!1)){e.next=9;break}return e.abrupt("return");case 9:return l="answer"===u.type,e.next=12,n.setRemoteDescription(u);case 12:if(l=!1,"offer"!==u.type){e.next=17;break}return e.next=16,n.setLocalDescription();case 16:r.send({description:n.localDescription});case 17:e.next=29;break;case 19:if(!d){e.next=29;break}return e.prev=20,e.next=23,n.addIceCandidate(d);case 23:e.next=29;break;case 25:if(e.prev=25,e.t0=e.catch(20),a){e.next=29;break}throw e.t0;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(2),console.error(e.t1);case 34:case"end":return e.stop()}}),e,null,[[2,31],[20,25]])})));return function(n){return e.apply(this,arguments)}}();var m=function(e){var n=e.target.readyState;console.log("Send channel state is: %s",n)};n.addEventListener("datachannel",(function(e){var n=e.channel;n.addEventListener("message",(function(e){console.log("Received Message: %s",e.data)})),n.addEventListener("open",m),n.addEventListener("close",m)}))};return b.addEventListener("open",p),b.addEventListener("close",(function(e){console.log("CLOSE WS",e)})),b.addEventListener("error",(function(e){console.error("ERROR WS",e),t(Object(h.f)("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0442\u0435\u043d\u0434\u0443 ".concat(R)))})),function(){b.close(1e3,"change room"),u.current&&u.current.close(),b.removeEventListener("open",p),r&&r.unsubscribe(),c.current.srcObject=null}}}),[R]),Object(a.useEffect)((function(){var e=function(){"visible"===document.visibilityState&&document.pictureInPictureElement&&document.exitPictureInPicture()};return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}}),[]);return r.a.createElement("div",{className:e.root},r.a.createElement(f.a,{variant:"standard",className:e.formControl},r.a.createElement(b.a,{htmlFor:"outlined-room-native-simple"},"\u0421\u0442\u0435\u043d\u0434"),r.a.createElement(p.a,{native:!0,value:R,onChange:function(e){D(e.target.value)},label:"\u0421\u0442\u0435\u043d\u0434\u0430",inputProps:{name:"\u0421\u0442\u0435\u043d\u0434",id:"outlined-room-native-simple"}},Array.from({length:5},(function(e,n){return n})).map((function(e){var n=0===e,t=n?"":e.toString();return r.a.createElement("option",{key:t,value:t,disabled:n,"aria-label":n?"None":t},t)})))),r.a.createElement("section",{className:e.video},r.a.createElement("video",{ref:c,autoPlay:!0,playsInline:!0,onClick:function(e){var n;(null===(n=c.current)||void 0===n?void 0:n.srcObject)&&(document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&e.target.requestPictureInPicture())}})),r.a.createElement(_,{pcRef:u}),r.a.createElement("section",null,r.a.createElement(g.a,{multiline:!0,value:k,onChange:function(e){if(!l.current){l.current=u.current.createDataChannel("sendDataChannel",null);var n=l.current;n.onopen=function(){x(!0)},n.onclose=function(){x(!1)}}y(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(v.a,{component:"button",color:"primary",onClick:function(){l.current&&w&&(l.current.send(k),y(""))},variant:"contained",type:"submit",size:"small",disabled:!w},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443")))},W=t(143),H=t(148),J=t(54),V=t(55),B=t(147),K=t(36),Q=t(61),X=Object(E.a)((function(e){return{layout:Object(m.a)({width:"auto",marginLeft:e.spacing(2),marginRight:e.spacing(2)},e.breakpoints.up(350+2*e.spacing(2)),{width:350,marginLeft:"auto",marginRight:"auto"}),paper:Object(m.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2),height:190},e.breakpoints.up(350+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),button:{marginTop:e.spacing(3),display:"flex",justifyContent:"center"}}})),Y=function(){var e=X(),n=Object(O.c)();return r.a.createElement("main",{className:e.layout},r.a.createElement(W.a,{className:e.paper,variant:"outlined",square:!0},r.a.createElement(F.a,{component:"h5",variant:"h5",align:"center"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:e.button},r.a.createElement(J.GoogleLogin,{clientId:V.GOOGLE_AUTH,buttonText:"\u0412\u043e\u0439\u0442\u0438",onSuccess:function(e){n(Object(K.c)(Object(Q.a)(Object(Q.a)({},e.profileObj),{},{id_token:e.tokenObj.id_token})))},onFailure:function(e){console.error(e)},cookiePolicy:"single_host_origin",isSignedIn:!0}))))};n.default=function(){var e=Object(O.c)(),n=Object(O.d)((function(e){return e.auth}),O.b),t=n.imageUrl,a=n.email,c=n.name,o=!!c;return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null),o?r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{elevation:1,variant:"outlined",square:!0},r.a.createElement(H.a,null,r.a.createElement(T.a,{mr:1},r.a.createElement(S.a,{alt:c,src:t})),r.a.createElement(L.a,{primary:c,secondary:a}),r.a.createElement(J.GoogleLogout,{clientId:V.GOOGLE_AUTH,buttonText:"\u0412\u044b\u0439\u0442\u0438",onLogoutSuccess:function(){e(Object(K.a)())}}))),r.a.createElement(T.a,{m:2},r.a.createElement(W.a,{elevation:3,variant:"outlined"},r.a.createElement(M,null)))):r.a.createElement(Y,null))}},104:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(8),o=t.n(c),i=t(15),s=t(22),u=t(18),l=t(36),d=Object(s.b)({name:"led",initialState:{pin1:!1,pin2:!1,pin3:!1},reducers:{setLed:function(e,n){return n.payload}}}),m=(d.actions.setLed,d.reducer),f=t(17),b=Object(u.c)({auth:l.b,led:m,fileLoader:f.c});var p=Object(s.a)({reducer:b});t(99);!function(){var e=t(103).default;o.a.render(r.a.createElement(i.a,{store:p},r.a.createElement(e,null)),document.getElementById("root"))}()},17:function(e,n,t){"use strict";t.d(n,"g",(function(){return i})),t.d(n,"f",(function(){return s})),t.d(n,"b",(function(){return u})),t.d(n,"a",(function(){return l})),t.d(n,"d",(function(){return d})),t.d(n,"e",(function(){return m}));var a=t(22),r={maxProgress:0,progressValue:0,snackbarSuccess:"",snackbarError:""},c=Object(a.b)({name:"fileLoader",initialState:r,reducers:{reset:function(){return r},setSnackbarSuccess:function(e,n){return e.snackbarSuccess=n.payload,e},setSnackbarError:function(e,n){return e.snackbarError=n.payload,e},closeSuccessSnackbar:function(e){return e.snackbarSuccess=r.snackbarSuccess,e},closeErrorSnackbar:function(e){return e.snackbarError=r.snackbarError,e},setMaxProgress:function(e,n){return e.maxProgress=n.payload,e},setProgressValue:function(e,n){return e.progressValue=n.payload,e}}}),o=c.actions,i=(o.reset,o.setSnackbarSuccess),s=o.setSnackbarError,u=o.closeSuccessSnackbar,l=o.closeErrorSnackbar,d=o.setMaxProgress,m=o.setProgressValue;n.c=c.reducer},36:function(e,n,t){"use strict";t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return s}));var a=t(22),r={},c=Object(a.b)({name:"auth",initialState:r,reducers:{getProfile:function(e,n){return n.payload},clearProfile:function(){return r}}}),o=c.actions,i=o.getProfile,s=o.clearProfile;n.b=c.reducer},55:function(e){e.exports=JSON.parse('{"GOOGLE_AUTH":"930914015370-b31p63biqg1j0pbfr96qei9ujp1ttded.apps.googleusercontent.com"}')},89:function(e,n,t){e.exports=t(104)},99:function(e,n,t){}},[[89,1,2]]]);
//# sourceMappingURL=main.8afa4935.chunk.js.map