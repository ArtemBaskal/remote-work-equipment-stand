(this["webpackJsonpremote-work-equipment-stand"]=this["webpackJsonpremote-work-equipment-stand"]||[]).push([[0],{100:function(e,n,t){},103:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(48),o=t.n(c),i=t(61),s=t(28),l=t(72),u=t(73),d=function(){function e(n){Object(l.a)(this,e),this.signaling=n}return Object(u.a)(e,[{key:"send",value:function(e){this.signaling.send(JSON.stringify({data:e}))}},{key:"unsubscribe",value:function(){console.error("Method unsubscribe is not implemented")}},{key:"onmessage",set:function(e){var n=this,t=function(n){var t=n.data;e(JSON.parse(t))};this.signaling.addEventListener("message",t),this.unsubscribe=function(){console.log("unsubscribe from message"),n.signaling.removeEventListener("message",t)}}}]),e}(),m=t(31),f=t(143),b=t(155),p=t(149),g=t(157),v=t(142),E=t(135),O=t(13),h=t(22),j=t(136),y=t(137),k=t(138),S=t(154),L=t(139),w=t(140),x=t(141),P=t(77),C=t.n(P),R=t(78),D=t.n(R),I=t(150),N=t(133),T=t(57),q=function(e){var n=e.value;return r.a.createElement(I.a,{display:"flex",alignItems:"center"},r.a.createElement(I.a,{width:"100%",mr:1},r.a.createElement(N.a,Object.assign({variant:"determinate"},e))),r.a.createElement(I.a,{minWidth:35},r.a.createElement(T.a,{variant:"body2",color:"textSecondary"},"".concat(Math.round(n),"%"))))},F=t(35),M=Object(E.a)((function(){return{progress:{width:"100%"},file:{display:"flex"}}})),A=function(e){var n=e.pcRef,t=Object(O.c)(),c=M(),o=Object(O.d)((function(e){return e.fileLoader}),O.b),i=o.maxProgress,l=o.progressValue,u=Object(a.useState)(null),d=Object(s.a)(u,2),m=d[0],f=d[1];Object(a.useEffect)((function(){var e=window;function n(e){e.stopPropagation(),e.preventDefault()}function t(e){e.stopPropagation(),e.preventDefault()}function a(e){e.stopPropagation(),e.preventDefault();var n=Object(s.a)(e.dataTransfer.files,1)[0];f(n)}return e.addEventListener("dragenter",n,!1),e.addEventListener("dragover",t,!1),e.addEventListener("drop",a,!1),function(){e.removeEventListener("dragenter",n,!1),e.removeEventListener("dragover",t,!1),e.removeEventListener("drop",a,!1)}}),[]);var b,p,g=function(){f(null)};return r.a.createElement("section",null,r.a.createElement("input",{type:"file",id:"files",style:{display:"none"},onChange:function(e){var n=e.target.files;f(n[0])}}),m&&r.a.createElement(j.a,{className:c.file},r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(S.a,null,r.a.createElement(C.a,null))),r.a.createElement(L.a,{primary:m.name,secondary:new Date(m.lastModified).toLocaleString(),title:"".concat(m.size," \u0431\u0430\u0439\u0442")}),r.a.createElement(w.a,null,r.a.createElement(x.a,{edge:"end","aria-label":"delete",onClick:g},r.a.createElement(D.a,null))))),l>0&&m?r.a.createElement("div",{className:c.progress},r.a.createElement(q,{value:(b=l,p=i,100*(b-0)/(p-0))})):r.a.createElement("br",null),m&&r.a.createElement(v.a,{component:"button",color:"primary",onClick:function(){if(m&&n.current){var e=n.current.createDataChannel(m.name);e.binaryType="arraybuffer",t(Object(F.b)(m.size));var a=new FileReader,r=0;a.addEventListener("error",(function(e){console.error("Error reading selectedFile: ",e)})),a.addEventListener("abort",(function(e){console.log("File reading aborted: ",e)}));var c=!1,o=function(e){console.log("readSlice",e);var n=m.slice(r,e+262144);a.readAsArrayBuffer(n)};a.addEventListener("load",(function(n){var a;if(console.log("FileReader.onload",n),(null===(a=n.target)||void 0===a?void 0:a.result)&&"open"===e.readyState)if(c)console.warn("Unable to write, data channel is paused!");else{var i=n.target.result;if(e.send(i),r+=i.byteLength,t(Object(F.c)(r)),r>=m.size)return e.send("EOF"),e.close(),f(null),t(Object(F.b)(0)),t(Object(F.c)(0)),g(),void t(Object(h.d)("\u0424\u0430\u0439\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"));c||e.bufferedAmount<1048576?o(r):(console.log("Data channel ".concat(e.label," paused @ ").concat(e.bufferedAmount)),c=!0)}else console.warn("sendFileChannel.readyState is not open:",e.readyState)})),e.bufferedAmountLowThreshold=262144,e.addEventListener("bufferedamountlow",(function(){c&&(console.debug("Data channel ".concat(e.label," resumed @ ").concat(e.bufferedAmount)),c=!1,o(r))})),e.onopen=function(){o(0)}}},variant:"contained",type:"submit",size:"small"},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"),r.a.createElement(v.a,{component:"label",htmlFor:"files",variant:"contained",size:"small",id:"files"},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0448\u0438\u0432\u043a\u0443"))},G={iceServers:[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"9u7prU:2}R{Sut~.)d[bP7,;Pgc'Pa",username:"fkrveacbukypqsqyaq@miucce.com"}]},_=Object(E.a)((function(e){return{root:{flexGrow:1,"& > *":{margin:e.spacing(1)},padding:"2rem"},formControl:{margin:e.spacing(1),minWidth:"10rem"},video:{display:"flex",justifyContent:"center",flexDirection:"column",backgroundImage:"url(".concat("/remote-work-equipment-stand","/chip.png)"),backgroundSize:"5.5rem",backgroundRepeat:"space",width:"100%",minHeight:"30rem"}}})),U=function(){var e=Object(O.c)(),n=_(),t=Object(O.d)((function(e){return e.auth.id_token})),c=Object(a.useRef)(null),l=Object(a.useRef)(null),u=Object(a.useRef)(null),E=Object(a.useState)(""),j=Object(s.a)(E,2),y=j[0],k=j[1],S=Object(a.useState)(!1),L=Object(s.a)(S,2),w=L[0],x=L[1],P=Object(a.useState)(""),C=Object(s.a)(P,2),R=C[0],D=C[1];Object(a.useEffect)((function(){if(""!==R){var n,a,r,u=(n="room",a=R,new URLSearchParams(Object(m.a)({},n,a)).toString()),f=new URL("".concat(u&&"?".concat(u)),"wss://wss-signaling.herokuapp.com").toString(),b=new WebSocket(f,["id_token",t]),p=function(e){console.log("OPEN WS",e),(r=new d(b)).send({getRemoteMedia:!0});var n=new RTCPeerConnection(G);l.current=n,n.ontrack=function(e){var n=e.track,t=Object(s.a)(e.streams,1)[0];n.onunmute=function(){c.current.srcObject||(c.current.srcObject=t)}};var t=!1,a=!1,u=!1;n.onicecandidate=function(e){var n=e.candidate;r.send({candidate:n})},n.onnegotiationneeded=Object(i.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=!0,e.next=4,n.setLocalDescription();case 4:r.send({description:n.localDescription}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:return e.prev=10,t=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])}))),n.oniceconnectionstatechange=function(){"failed"===n.iceConnectionState&&n.restartIce()},r.onmessage=function(){var e=Object(i.a)(o.a.mark((function e(c){var i,s,l,d,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c.data,s=c.data,l=s.description,d=s.candidate,console.log(i),e.prev=2,!l){e.next=19;break}if(m=!t&&("stable"===n.signalingState||u),"offer"===l.type&&!m,!(a=!1)){e.next=9;break}return e.abrupt("return");case 9:return u="answer"===l.type,e.next=12,n.setRemoteDescription(l);case 12:if(u=!1,"offer"!==l.type){e.next=17;break}return e.next=16,n.setLocalDescription();case 16:r.send({description:n.localDescription});case 17:e.next=29;break;case 19:if(!d){e.next=29;break}return e.prev=20,e.next=23,n.addIceCandidate(d);case 23:e.next=29;break;case 25:if(e.prev=25,e.t0=e.catch(20),a){e.next=29;break}throw e.t0;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(2),console.error(e.t1);case 34:case"end":return e.stop()}}),e,null,[[2,31],[20,25]])})));return function(n){return e.apply(this,arguments)}}();var m=function(e){var n=e.target.readyState;console.log("Send channel state is: %s",n)};n.addEventListener("datachannel",(function(e){var n=e.channel;n.addEventListener("message",(function(e){console.log("Received Message: %s",e.data)})),n.addEventListener("open",m),n.addEventListener("close",m)}))};return b.addEventListener("open",p),b.addEventListener("close",(function(e){console.log("CLOSE WS",e)})),b.addEventListener("error",(function(n){console.error("ERROR WS",n),e(Object(h.c)("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0441\u0442\u0435\u043d\u0434\u0443 ".concat(R)))})),function(){b.close(1e3,"change room"),l.current&&l.current.close(),b.removeEventListener("open",p),r&&r.unsubscribe(),c.current.srcObject=null}}}),[R]),Object(a.useEffect)((function(){var e=function(){"visible"===document.visibilityState&&document.pictureInPictureElement&&document.exitPictureInPicture()};return document.addEventListener("visibilitychange",e),function(){document.removeEventListener("visibilitychange",e)}}),[]);return r.a.createElement("div",{className:n.root},r.a.createElement(f.a,{variant:"standard",className:n.formControl},r.a.createElement(b.a,{htmlFor:"outlined-room-native-simple"},"\u0421\u0442\u0435\u043d\u0434"),r.a.createElement(p.a,{native:!0,value:R,onChange:function(e){D(e.target.value)},label:"\u0421\u0442\u0435\u043d\u0434\u0430",inputProps:{name:"\u0421\u0442\u0435\u043d\u0434",id:"outlined-room-native-simple"}},Array.from({length:5},(function(e,n){return n})).map((function(e){var n=0===e,t=n?"":e.toString();return r.a.createElement("option",{key:t,value:t,disabled:n,"aria-label":n?"None":t},t)})))),r.a.createElement("section",{className:n.video},r.a.createElement("video",{ref:c,autoPlay:!0,playsInline:!0,onClick:function(e){var n;(null===(n=c.current)||void 0===n?void 0:n.srcObject)&&(document.pictureInPictureElement?document.exitPictureInPicture():document.pictureInPictureEnabled&&e.target.requestPictureInPicture())}})),r.a.createElement(A,{pcRef:l}),r.a.createElement("section",null,r.a.createElement(g.a,{multiline:!0,value:y,onChange:function(e){if(!u.current){u.current=l.current.createDataChannel("sendDataChannel",null);var n=u.current;n.onopen=function(){x(!0)},n.onclose=function(){x(!1)}}k(e.target.value)}}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(v.a,{component:"button",color:"primary",onClick:function(){u.current&&w&&(u.current.send(y),k(""))},variant:"contained",type:"submit",size:"small",disabled:!w},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u0430\u043d\u0434\u0443")))},z=t(146),W=t(148),H=t(55),J=t(151),V=t(153),B=function(e){var n=e.snackbarDelay,t=Object(O.c)(),a=Object(O.d)((function(e){return e.snackbar}),O.b),c=a.open,o=a.snackbarMessage,i=a.type,s=function(){t(Object(h.a)())};return r.a.createElement(V.a,{open:c,autoHideDuration:n,onClose:s,onClick:s},r.a.createElement(J.a,{severity:i},o))};B.defaultProps={snackbarDelay:6e3};var K=t(56),Q=t(147),X=t(37),Y=t(62),Z=Object(E.a)((function(e){return{layout:Object(m.a)({width:"auto",marginLeft:e.spacing(2),marginRight:e.spacing(2)},e.breakpoints.up(350+2*e.spacing(2)),{width:350,marginLeft:"auto",marginRight:"auto"}),paper:Object(m.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2),height:190},e.breakpoints.up(350+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),button:{marginTop:e.spacing(3),display:"flex",justifyContent:"center"}}})),$=function(){var e=Z(),n=Object(O.c)();return r.a.createElement("main",{className:e.layout},r.a.createElement(z.a,{className:e.paper,variant:"outlined",square:!0},r.a.createElement(T.a,{component:"h5",variant:"h5",align:"center"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:e.button},r.a.createElement(H.GoogleLogin,{clientId:K.GOOGLE_AUTH,buttonText:"\u0412\u043e\u0439\u0442\u0438",onSuccess:function(e){n(Object(X.c)(Object(Y.a)(Object(Y.a)({},e.profileObj),{},{id_token:e.tokenObj.id_token})))},onFailure:function(e){console.error(e)},cookiePolicy:"single_host_origin",isSignedIn:!0}))))};n.default=function(){var e=Object(O.c)(),n=Object(O.d)((function(e){return e.auth}),O.b),t=n.imageUrl,a=n.email,c=n.name,o=!!c;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,null),r.a.createElement(B,null),o?r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{elevation:1,variant:"outlined",square:!0},r.a.createElement(W.a,null,r.a.createElement(I.a,{mr:1},r.a.createElement(S.a,{alt:c,src:t})),r.a.createElement(L.a,{primary:c,secondary:a}),r.a.createElement(H.GoogleLogout,{clientId:K.GOOGLE_AUTH,buttonText:"\u0412\u044b\u0439\u0442\u0438",onLogoutSuccess:function(){e(Object(X.a)())}}))),r.a.createElement(I.a,{m:2},r.a.createElement(z.a,{elevation:3,variant:"outlined"},r.a.createElement(U,null)))):r.a.createElement($,null))}},104:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),c=t(8),o=t.n(c),i=t(13),s=t(17),l=t(37),u=t(35),d=Object(s.b)({name:"led",initialState:{pin1:!1,pin2:!1,pin3:!1},reducers:{setLed:function(e,n){return n.payload}}}),m=(d.actions.setLed,d.reducer),f=t(22),b=t(18),p=Object(b.c)({auth:l.b,fileLoader:u.a,led:m,snackbar:f.b});var g=Object(s.a)({reducer:p});t(100);!function(){var e=t(103).default;o.a.render(r.a.createElement(i.a,{store:g},r.a.createElement(e,null)),document.getElementById("root"))}()},22:function(e,n,t){"use strict";t.d(n,"d",(function(){return i})),t.d(n,"c",(function(){return s})),t.d(n,"a",(function(){return l}));var a=t(17),r={snackbarMessage:"",type:"info",open:!1},c=Object(a.b)({name:"snackbar",initialState:r,reducers:{reset:function(){return r},setSnackbarSuccess:function(e,n){return e.snackbarMessage=n.payload,e.type="success",e.open=!0,e},setSnackbarError:function(e,n){return e.snackbarMessage=n.payload,e.type="error",e.open=!0,e},closeSnackbar:function(e){return e.open=!1,e}}}),o=c.actions,i=(o.reset,o.setSnackbarSuccess),s=o.setSnackbarError,l=o.closeSnackbar;n.b=c.reducer},35:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return s}));var a=t(17),r={maxProgress:0,progressValue:0},c=Object(a.b)({name:"fileLoader",initialState:r,reducers:{reset:function(){return r},setMaxProgress:function(e,n){return e.maxProgress=n.payload,e},setProgressValue:function(e,n){return e.progressValue=n.payload,e}}}),o=c.actions,i=(o.reset,o.setMaxProgress),s=o.setProgressValue;n.a=c.reducer},37:function(e,n,t){"use strict";t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return s}));var a=t(17),r={},c=Object(a.b)({name:"auth",initialState:r,reducers:{getProfile:function(e,n){return n.payload},clearProfile:function(){return r}}}),o=c.actions,i=o.getProfile,s=o.clearProfile;n.b=c.reducer},56:function(e){e.exports=JSON.parse('{"GOOGLE_AUTH":"930914015370-b31p63biqg1j0pbfr96qei9ujp1ttded.apps.googleusercontent.com"}')},90:function(e,n,t){e.exports=t(104)}},[[90,1,2]]]);
//# sourceMappingURL=main.620f978a.chunk.js.map